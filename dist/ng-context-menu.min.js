!function(e){"use strict";e.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{element:null,menuElement:null}}).directive("contextMenu",["$document","ContextMenuService","$parse",function(n,t,l){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled",closeCallback:"&contextMenuClose",marginBottom:"@contextMenuMarginBottom"},link:function(o,c,u){function i(e,t){t.addClass("open");var l=n[0].documentElement,c=(window.pageXOffset||l.scrollLeft)-(l.clientLeft||0),u=(window.pageYOffset||l.scrollTop)-(l.clientTop||0),i=t[0].scrollWidth,a=t[0].scrollHeight,m=l.clientWidth+c,r=l.clientHeight+u,s=i+e.pageX,p=a+e.pageY,f=Math.max(e.pageX-c,0),g=Math.max(e.pageY-u,0);if(s>m&&(f-=s-m),p>r){var b=o.marginBottom||0;g=g-(p-r)-b}t.css("top",g+"px"),t.css("left",f+"px"),d(!0)}function a(e){e.removeClass("open"),s&&o.closeCallback(),d(!1)}function m(e){!o.disabled()&&s&&27===e.keyCode&&o.$apply(function(){a(t.menuElement)})}function r(e){o.disabled()||!s||2===e.button&&e.target===t.element||o.$apply(function(){a(t.menuElement)})}function d(e){if(s=e,null!=t.menuElement){var n=t.menuElement.attr("context-menu-opened");if(void 0!==n){var o=l(n);o.assign(t.menuElement.scope(),e)}}}var s=!1;d(!1),c.bind("contextmenu",function(n){o.disabled()||(null!==t.menuElement&&a(t.menuElement),t.menuElement=e.element(document.getElementById(u.target)),t.element=n.target,n.preventDefault(),n.stopPropagation(),o.$apply(function(){o.callback({$event:n})}),o.$apply(function(){i(n,t.menuElement)}))}),n.bind("keyup",m),n.bind("click",r),n.bind("contextmenu",r),o.$on("$destroy",function(){n.unbind("keyup",m),n.unbind("click",r),n.unbind("contextmenu",r)})}}}])}(angular);